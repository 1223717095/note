Volatile

	非原子的64位操作
	double和long的读写是非原子操作
	加上volatile关键字
	
	可见性
	原子性：对单个读/写操作具有原子性，volatile++这种复合操作不具备原子性
	
	内存语义
		写入会刷新到主内存
		读取会从主内存读取
		
	
	语义实现
		编译器重排序
			当第一个操作为volatile读时不管第二个操作是什么都不能重排序
			当第二个操作为volatile写时不管第一个操作是什么都不能重排序
			
		处理器重排序
			通过生成字节码时插入内存屏障来阻止处理器重排序
			
			
			
Lock
	
	内存语义（与volatile相同）
		获得锁时，将本地内存置为无效，直接从主内存读取
		释放锁时，将本地内存刷新回主内存
		
		公平锁与非公平锁在释放时。最后都要写一个volatile类型的变量state
		公平锁获取时，首先会读volatile类型的变量state
		非公平锁获取时，首先用CAS更新volatile类型的变量
		
final
	内存语义
		禁止将final域的写重排序到构造函数外
		初次读一个包含final域对象的引用，与初次读这个final域，这2个操作之间不能重排序
		
		//final为引用类型时（final引用不能溢出）
		构造器内final域的写入，与这个对象（包含final域的对象）赋值给一个引用变量，这2个操作之间不能重排序
		
		
		
加锁的含义不只局限于互斥，还包括内存可见性		
		
		
		
		
		
		
		
		
		
		
		
		
			
			
			